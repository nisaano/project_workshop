import sys
import os
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

from ml_enhancer import AdvancedTextEnhancer

def run_comprehensive_tests():
    enhancer = AdvancedTextEnhancer()
    
    print("üß™ –ó–ê–ü–£–°–ö –ö–û–ú–ü–õ–ï–ö–°–ù–´–• –¢–ï–°–¢–û–í ML-–ú–û–î–£–õ–Ø")
    print("=" * 60)
    
    # –¢–µ—Å—Ç 1: –¢–µ–∫—Å—Ç —Å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è–º–∏
    print("\n1. üìù –¢–ï–°–¢: –¢–µ–∫—Å—Ç —Å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è–º–∏")
    test_repetitive = """
    –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ - —ç—Ç–æ –≤–∞–∂–Ω–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è. –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ.
    –ê–ª–≥–æ—Ä–∏—Ç–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –±—ã–≤–∞—é—Ç —Ä–∞–∑–Ω—ã–µ. –ê–ª–≥–æ—Ä–∏—Ç–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —É—á–∞—Ç—Å—è –Ω–∞ –¥–∞–Ω–Ω—ã—Ö.
    –ì–ª—É–±–æ–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ - —ç—Ç–æ —á–∞—Å—Ç—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –ì–ª—É–±–æ–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏.
    –ù–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ –∏–º–∏—Ç–∏—Ä—É—é—Ç –º–æ–∑–≥. –ù–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ —Å–æ—Å—Ç–æ—è—Ç –∏–∑ —Å–ª–æ–µ–≤.
    """
    result1 = enhancer.process_text(test_repetitive)
    print("–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç:", len(test_repetitive), "—Å–∏–º–≤–æ–ª–æ–≤")
    print("–†–µ–∑—É–ª—å—Ç–∞—Ç:", len(result1), "—Å–∏–º–≤–æ–ª–æ–≤")
    print("–£–ª—É—á—à–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:\n", result1)

    # –¢–µ—Å—Ç 2: –ù–∞—É—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å —Ç–µ—Ä–º–∏–Ω–∞–º–∏
    print("\n2. üî¨ –¢–ï–°–¢: –ù–∞—É—á–Ω—ã–π —Ç–µ–∫—Å—Ç")
    test_scientific = """
    –ö–≤–∞–Ω—Ç–æ–≤–∞—è —Å—É–ø–µ—Ä–ø–æ–∑–∏—Ü–∏—è —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–º –ø—Ä–∏–Ω—Ü–∏–ø–æ–º –∫–≤–∞–Ω—Ç–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–∏. 
    –ß–∞—Å—Ç–∏—Ü–∞ –º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –í–æ–ª–Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è 
    –æ–ø–∏—Å—ã–≤–∞–µ—Ç —ç—Ç–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è. –ö–æ–ª–ª–∞–ø—Å –≤–æ–ª–Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–∏. 
    –ö–æ—Ç –®—Ä—ë–¥–∏–Ω–≥–µ—Ä–∞ - –∏–∑–≤–µ—Å—Ç–Ω—ã–π –º—ã—Å–ª–µ–Ω–Ω—ã–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 1935 –≥–æ–¥–∞. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç 
    –ø–∞—Ä–∞–¥–æ–∫—Å —Å—É–ø–µ—Ä–ø–æ–∑–∏—Ü–∏–∏. –ö–≤–∞–Ω—Ç–æ–≤–∞—è –∑–∞–ø—É—Ç–∞–Ω–Ω–æ—Å—Ç—å –±—ã–ª–∞ –æ–ø–∏—Å–∞–Ω–∞ –≠–π–Ω—à—Ç–µ–π–Ω–æ–º –≤ 1935 –≥–æ–¥—É. 
    –ó–∞–ø—É—Ç–∞–Ω–Ω—ã–µ —á–∞—Å—Ç–∏—Ü—ã –≤–ª–∏—è—é—Ç –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.
    """
    result2 = enhancer.process_text(test_scientific)
    print("–ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã:", enhancer.extract_key_terms(test_scientific))
    print("–£–ª—É—á—à–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:\n", result2)

    # –¢–µ—Å—Ç 3: –¢–µ–∫—Å—Ç —Å –¥–∞—Ç–∞–º–∏
    print("\n3. üìÖ –¢–ï–°–¢: –¢–µ–∫—Å—Ç —Å –¥–∞—Ç–∞–º–∏")
    test_dates = """
    –ü–µ—Ä–≤–∞—è –º–∏—Ä–æ–≤–∞—è –≤–æ–π–Ω–∞ –Ω–∞—á–∞–ª–∞—Å—å 28.07.1914 –∏ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å 11.11.1918. 
    –í—Ç–æ—Ä–∞—è –º–∏—Ä–æ–≤–∞—è –≤–æ–π–Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–ª–∞—Å—å —Å 1939 –ø–æ 1945 –≥–æ–¥. 
    –•–æ–ª–æ–¥–Ω–∞—è –≤–æ–π–Ω–∞ –¥–ª–∏–ª–∞—Å—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Å 1947 –ø–æ 1991 –≥–æ–¥. 
    –†–∞—Å–ø–∞–¥ –°–°–°–† –ø—Ä–æ–∏–∑–æ—à–µ–ª –≤ 1991 –≥–æ–¥—É. –í–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è: 1961 - –ø–æ–ª–µ—Ç –ì–∞–≥–∞—Ä–∏–Ω–∞, 
    1969 - –≤—ã—Å–∞–¥–∫–∞ –Ω–∞ –õ—É–Ω—É, 1991 - —Ä–∞—Å–ø–∞–¥ –°–°–°–†.
    """
    result3 = enhancer.process_text(test_dates)
    print("–£–ª—É—á—à–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:\n", result3)

    # –¢–µ—Å—Ç 4: –ö–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç
    print("\n4. üìè –¢–ï–°–¢: –ö–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç")
    test_short = "–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤—Å–µ –±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–º."
    result4 = enhancer.process_text(test_short)
    print("–ò—Å—Ö–æ–¥–Ω—ã–π:", test_short)
    print("–†–µ–∑—É–ª—å—Ç–∞—Ç:", result4)

    # –¢–µ—Å—Ç 5: –î–ª–∏–Ω–Ω—ã–π —Å–ª–æ–∂–Ω—ã–π —Ç–µ–∫—Å—Ç
    print("\n5. üìö –¢–ï–°–¢: –î–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç")
    test_long = """
    
    """
    result5 = enhancer.process_text(test_long)
    print("–ò—Å—Ö–æ–¥–Ω—ã–π:", len(test_long), "—Å–∏–º–≤–æ–ª–æ–≤")
    print("–†–µ–∑—É–ª—å—Ç–∞—Ç:", len(result5), "—Å–∏–º–≤–æ–ª–æ–≤")
    print("–£–ª—É—á—à–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:\n", result5)

def test_individual_methods():
    """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤"""
    print("\n" + "=" * 60)
    print("üîç –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –û–¢–î–ï–õ–¨–ù–´–• –ú–ï–¢–û–î–û–í")
    print("=" * 60)
    
    enhancer = AdvancedTextEnhancer()
    test_text = "–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∏ –≥–ª—É–±–æ–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ. –ù–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ –∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã."
    
    print("\n1. extract_key_terms():")
    terms = enhancer.extract_key_terms(test_text)
    print("   –¢–µ—Ä–º–∏–Ω—ã:", terms)
    
    print("\n2. remove_repetitive_phrases():")
    repetitive_text = "–ê–ª–≥–æ—Ä–∏—Ç–º—ã –≤–∞–∂–Ω—ã. –ê–ª–≥–æ—Ä–∏—Ç–º—ã –æ–±—É—á–∞—é—Ç—Å—è. –ê–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç."
    cleaned = enhancer.remove_repetitive_phrases(repetitive_text)
    print("   –î–æ:", repetitive_text)
    print("   –ü–æ—Å–ª–µ:", cleaned)
    
    print("\n3. improve_paragraph_structure():")
    structured = enhancer.improve_paragraph_structure(test_text * 3)
    print("   –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:\n", structured)

def performance_test():
    """–¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"""
    print("\n" + "=" * 60)
    print("‚ö° –¢–ï–°–¢ –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò")
    print("=" * 60)
    
    enhancer = AdvancedTextEnhancer()
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è —Ç–µ—Å—Ç–∞
    sample_sentence = "–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –º–µ–Ω—è–µ—Ç –º–∏—Ä. "
    long_text = sample_sentence * 50
    
    import time
    start_time = time.time()
    
    result = enhancer.process_text(long_text)
    
    end_time = time.time()
    processing_time = end_time - start_time
    
    print(f"–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –∏–∑ {len(long_text)} —Å–∏–º–≤–æ–ª–æ–≤:")
    print(f"–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: {processing_time:.2f} —Å–µ–∫—É–Ω–¥")
    print(f"–°–∫–æ—Ä–æ—Å—Ç—å: {len(long_text) / processing_time:.0f} —Å–∏–º–≤–æ–ª–æ–≤/—Å–µ–∫—É–Ω–¥—É")
    print(f"–°–∂–∞—Ç–∏–µ: {len(result)} / {len(long_text)} —Å–∏–º–≤–æ–ª–æ–≤ ({(len(result)/len(long_text)*100):.1f}%)")

if __name__ == "__main__":
    run_comprehensive_tests()
    test_individual_methods()
    performance_test()
